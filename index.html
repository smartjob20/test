<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù¾Ø±Ø³Ø´â€ŒÙ†Ø§Ù…Ù‡ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø®ØªÛŒ | WebLegend Project</title>
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        :root {
            --bg-color: #0f0f13; /* Ù…Ø´Ú©ÛŒ Ø¹Ù…ÛŒÙ‚ */
            --card-bg: rgba(30, 30, 35, 0.7); /* Ø´ÛŒØ´Ù‡â€ŒØ§ÛŒ ØªÛŒØ±Ù‡ */
            --primary-silver: #e0e0e0;
            --accent-silver: #a0a0a0;
            --highlight: #ffffff;
            --text-main: #f5f5f5;
            --text-muted: #888888;
            --transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        * {
            box-sizing: border-box;
            outline: none;
        }

        body {
            margin: 0;
            font-family: 'Vazirmatn', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(circle at 50% 0%, #2a2a2a 0%, var(--bg-color) 80%);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
        }

        /* Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø§ØµÙ„ÛŒ */
        .container {
            width: 100%;
            max-width: 700px;
            background: var(--card-bg);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            position: relative;
            margin: 20px;
        }

        /* Ù†ÙˆØ§Ø± Ù¾ÛŒØ´Ø±ÙØª */
        .progress-container {
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 4px;
            background: rgba(255,255,255,0.1);
            border-radius: 20px 20px 0 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-silver), var(--highlight));
            width: 0%;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px var(--highlight);
        }

        /* ØªØ§ÛŒÙ¾ÙˆÚ¯Ø±Ø§ÙÛŒ */
        h1, h2 {
            text-align: center;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(to bottom, #fff, #aaa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            text-align: center;
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-bottom: 30px;
        }

        /* Ù…Ø±Ø§Ø­Ù„ ÙØ±Ù… */
        .step {
            display: none;
            animation: fadeIn 0.6s ease;
        }

        .step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Ø§Ø³ØªØ§ÛŒÙ„ ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§ */
        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: var(--primary-silver);
            font-size: 0.95rem;
        }

        input[type="number"], select {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 10px;
            color: #fff;
            font-family: inherit;
            transition: var(--transition);
        }

        input[type="number"]:focus, select:focus {
            border-color: var(--primary-silver);
            background: rgba(255,255,255,0.1);
        }

        /* --- Ø§Ø³ØªØ§ÛŒÙ„ Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ Ø³Ù„Ú©Øª --- */
        select {
            background-color: rgba(255,255,255,0.05);
            color: #fff;
        }
        
        select option {
            background-color: #1a1a1a !important;
            color: #fff !important;
            padding: 10px;
        }

        /* Ø§Ø³ØªØ§ÛŒÙ„ Ø³ÙˆØ§Ù„Ø§Øª */
        .question-card {
            background: rgba(255,255,255,0.03);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-right: 3px solid transparent;
            transition: var(--transition);
        }

        .question-card:hover {
            background: rgba(255,255,255,0.06);
            border-right-color: var(--accent-silver);
        }

        .question-text {
            font-size: 1rem;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .options {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            flex-wrap: wrap;
        }

        .option-label {
            flex: 1;
            position: relative;
            cursor: pointer;
            min-width: 80px;
        }

        .option-label input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .option-custom {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px;
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            color: var(--text-muted);
            font-size: 0.8rem;
            transition: var(--transition);
            text-align: center;
        }

        .option-label input:checked ~ .option-custom {
            background: var(--primary-silver);
            color: #000;
            font-weight: bold;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        /* Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ */
        .btn-group {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 50px;
            font-family: inherit;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
        }

        .btn-next {
            background: linear-gradient(135deg, var(--primary-silver), #888);
            color: #1a1a1a;
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.2);
        }

        .btn-next:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(255, 255, 255, 0.3);
        }

        .btn-prev {
            background: transparent;
            color: var(--text-muted);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .btn-prev:hover {
            color: #fff;
            border-color: #fff;
        }

        /* Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ */
        @media (max-width: 600px) {
            .container { padding: 25px 20px; margin: 10px; }
            .options { flex-direction: column; }
            .option-custom { padding: 12px; }
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <form id="surveyForm" onsubmit="return false;">
            
            <div class="step active" id="step-0">
                <h1>Ø®ÙˆØ´â€ŒØ¢Ù…Ø¯ÛŒØ¯</h1>
                <p class="subtitle">Ù…Ø·Ø§Ù„Ø¹Ù‡ Ø±Ø§Ø¨Ø·Ù‡ ØªØµÙˆÛŒØ± Ø¨Ø¯Ù†ÛŒ Ø¨Ø§ Ø¹Ø²Øª Ù†ÙØ³ Ø¯Ø§Ù†Ø´Ø¬ÙˆÛŒØ§Ù†</p>
                <div style="text-align: justify; margin-bottom: 30px; color: #ccc; line-height: 1.8;">
                    <p>Ø¯Ø§Ù†Ø´Ø¬ÙˆÛŒ Ú¯Ø±Ø§Ù…ÛŒØŒ</p>
                    <p>Ø§ÛŒÙ† Ù¾Ø±Ø³Ø´â€ŒÙ†Ø§Ù…Ù‡ Ø¬Ù‡Øª Ø§Ù†Ø¬Ø§Ù… Ù¾Ø§ÛŒØ§Ù†â€ŒÙ†Ø§Ù…Ù‡ Ú©Ø§Ø±Ø´Ù†Ø§Ø³ÛŒ Ø§Ø±Ø´Ø¯ Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª. Ù‡Ø¯Ù Ù…Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ø¹Ù„Ù…ÛŒ Ø±Ø§Ø¨Ø·Ù‡ Ø¨ÛŒÙ† Ø§Ø­Ø³Ø§Ø³ Ø´Ù…Ø§ Ù†Ø³Ø¨Øª Ø¨Ù‡ Ø¨Ø¯Ù†ØªØ§Ù† Ùˆ Ø¹Ø²Øª Ù†ÙØ³ Ø´Ù…Ø§Ø³Øª.</p>
                    <p>ğŸ”´ <strong>ØªÙˆØ¬Ù‡:</strong> ØªÙ…Ø§Ù… Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ù…Ø§ Ú©Ø§Ù…Ù„Ø§Ù‹ <strong>Ù…Ø­Ø±Ù…Ø§Ù†Ù‡</strong> Ùˆ Ø¨Ø¯ÙˆÙ† Ù†Ø§Ù… Ø¨Ø§Ù‚ÛŒ Ù…ÛŒâ€ŒÙ…Ø§Ù†Ø¯.</p>
                    <p>â± Ø²Ù…Ø§Ù† Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²: Ø­Ø¯ÙˆØ¯ Ûµ Ø¯Ù‚ÛŒÙ‚Ù‡</p>
                </div>
                <div style="text-align: center;">
                    <button type="button" class="btn btn-next" onclick="nextStep()">Ø´Ø±ÙˆØ¹ Ù¾Ø±Ø³Ø´â€ŒÙ†Ø§Ù…Ù‡</button>
                </div>
            </div>

            <div class="step" id="step-1">
                <h2>Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¹Ù…ÙˆÙ…ÛŒ</h2>
                <p class="subtitle">Ù„Ø·ÙØ§Ù‹ Ù…Ø´Ø®ØµØ§Øª Ø²ÛŒØ± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯</p>
                
                <div class="form-group">
                    <label>Ø¬Ù†Ø³ÛŒØª</label>
                    <select id="gender" required>
                        <option value="" disabled selected>Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯...</option>
                        <option value="female">Ø²Ù†</option>
                        <option value="male">Ù…Ø±Ø¯</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Ø³Ù†</label>
                    <input type="number" id="age" placeholder="Ù…Ø«Ù„Ø§Ù‹ 22">
                </div>

                <div class="form-group">
                    <label>Ù…Ù‚Ø·Ø¹ ØªØ­ØµÛŒÙ„ÛŒ</label>
                    <select id="education">
                        <option value="" disabled selected>Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯...</option>
                        <option value="bachelor">Ú©Ø§Ø±Ø´Ù†Ø§Ø³ÛŒ</option>
                        <option value="master">Ú©Ø§Ø±Ø´Ù†Ø§Ø³ÛŒ Ø§Ø±Ø´Ø¯</option>
                        <option value="phd">Ø¯Ú©ØªØ±ÛŒ</option>
                    </select>
                </div>

                <div class="btn-group">
                    <button type="button" class="btn btn-prev" onclick="prevStep()">Ø¨Ø§Ø²Ú¯Ø´Øª</button>
                    <button type="button" class="btn btn-next" onclick="nextStep()">Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯</button>
                </div>
            </div>

            <div class="step" id="step-2">
                <h2>Ø¨Ø®Ø´ Ø§ÙˆÙ„: Ø®ÙˆØ¯Ø§Ø±Ø²Ø´Ù…Ù†Ø¯ÛŒ</h2>
                <p class="subtitle">Ù„Ø·ÙØ§Ù‹ Ù…ÛŒØ²Ø§Ù† Ù…ÙˆØ§ÙÙ‚Øª Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ø§ Ø¬Ù…Ù„Ø§Øª Ø²ÛŒØ± Ù…Ø´Ø®Øµ Ú©Ù†ÛŒØ¯</p>
                
                <div id="rosenberg-container"></div>

                <div class="btn-group">
                    <button type="button" class="btn btn-prev" onclick="prevStep()">Ø¨Ø§Ø²Ú¯Ø´Øª</button>
                    <button type="button" class="btn btn-next" onclick="nextStep()">Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯</button>
                </div>
            </div>

            <div class="step" id="step-3">
                <h2>Ø¨Ø®Ø´ Ø¯ÙˆÙ…: ØªØµÙˆÛŒØ± Ø¨Ø¯Ù†ÛŒ</h2>
                <p class="subtitle">Ø§Ø­Ø³Ø§Ø³ Ø´Ù…Ø§ Ù†Ø³Ø¨Øª Ø¨Ù‡ Ø¸Ø§Ù‡Ø±ØªØ§Ù†</p>
                
                <div id="bodyimage-container"></div>

                <div class="btn-group">
                    <button type="button" class="btn btn-prev" onclick="prevStep()">Ø¨Ø§Ø²Ú¯Ø´Øª</button>
                    <button type="button" class="btn btn-next" onclick="submitForm()">Ø«Ø¨Øª Ù†Ù‡Ø§ÛŒÛŒ</button>
                </div>
            </div>

            <div class="step" id="step-4" style="text-align: center;">
                <h1 style="color: var(--highlight);">Ø³Ù¾Ø§Ø³Ú¯Ø²Ø§Ø±ÛŒÙ…!</h1>
                <p class="subtitle">Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø± Ø³ÛŒØ³ØªÙ… Ø«Ø¨Øª Ø´Ø¯.</p>
                <div style="font-size: 50px; margin: 30px 0;">ğŸ’</div>
                <p style="color: #aaa;">Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§ÛŒÙ† ØµÙØ­Ù‡ Ø±Ø§ Ø¨Ø¨Ù†Ø¯ÛŒØ¯.</p>
            </div>

        </form>
    </div>

    <script>
        // --- 1. ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ùˆ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ ---
        const SUPABASE_URL = 'https://myefghnvegupqrvwfhua.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im15ZWZnaG52ZWd1cHFydndmaHVhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5ODg5NzMsImV4cCI6MjA4MTU2NDk3M30.oiDNiI1hEo6xN_p1yBYwBcCXzQj6FhDXAwTnD4vPs7k';
        
        // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² ØªØ¯Ø§Ø®Ù„ Ù†Ø§Ù…â€ŒÚ¯Ø°Ø§Ø±ÛŒ
        const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        const rosenbergQuestions = [
            "Ø±ÙˆÛŒ Ù‡Ù… Ø±ÙØªÙ‡ØŒ Ø§Ø² Ø®ÙˆØ¯Ù… Ø±Ø¶Ø§ÛŒØª Ø¯Ø§Ø±Ù….",
            "Ú¯Ø§Ù‡ÛŒ ÙÚ©Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù… Ø§ØµÙ„Ø§Ù‹ Ø¢Ø¯Ù… Ø®ÙˆØ¨ÛŒ Ù†ÛŒØ³ØªÙ….",
            "ÙÚ©Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù… ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ø«Ø¨Øª Ø²ÛŒØ§Ø¯ÛŒ Ø¯Ø§Ø±Ù….",
            "Ù…Ù† Ù‡Ù… Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù… Ù…Ø«Ù„ Ø¨ÛŒØ´ØªØ± Ù…Ø±Ø¯Ù… Ú©Ø§Ø±Ù‡Ø§ Ø±Ø§ Ø¨Ù‡ Ø®ÙˆØ¨ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡Ù….",
            "ÙÚ©Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù… Ú†ÛŒØ² Ø²ÛŒØ§Ø¯ÛŒ Ù†Ø¯Ø§Ø±Ù… Ú©Ù‡ Ø¨Ù‡ Ø¢Ù† Ø§ÙØªØ®Ø§Ø± Ú©Ù†Ù….",
            "Ú¯Ø§Ù‡ÛŒ ÙˆØ§Ù‚Ø¹Ø§Ù‹ Ø§Ø­Ø³Ø§Ø³ Ù…ÛŒâ€ŒÚ©Ù†Ù… Ú©Ù‡ Ø¢Ø¯Ù… Ø¨ÛŒâ€ŒÙØ§ÛŒØ¯Ù‡â€ŒØ§ÛŒ Ù‡Ø³ØªÙ….",
            "ÙÚ©Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù… Ù…Ù† Ø´Ø®Øµ Ø¨Ø§ Ø§Ø±Ø²Ø´ÛŒ Ù‡Ø³ØªÙ…ØŒ Ø­Ø¯Ø§Ù‚Ù„ Ù…Ø³Ø§ÙˆÛŒ Ø¨Ø§ Ø¯ÛŒÚ¯Ø±Ø§Ù†.",
            "Ú©Ø§Ø´ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø³ØªÙ… Ø§Ø­ØªØ±Ø§Ù… Ø¨ÛŒØ´ØªØ±ÛŒ Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ¯Ù… Ù‚Ø§Ø¦Ù„ Ø¨Ø§Ø´Ù….",
            "Ø¨Ø§ Ù‡Ù…Ù‡ Ø§ÛŒÙ†â€ŒÙ‡Ø§ØŒ ÙÚ©Ø± Ù…ÛŒâ€ŒÚ©Ù†Ù… Ú©Ù‡ Ø¢Ø¯Ù… Ø´Ú©Ø³Øªâ€ŒØ®ÙˆØ±Ø¯Ù‡â€ŒØ§ÛŒ Ù‡Ø³ØªÙ….",
            "Ù†Ø³Ø¨Øª Ø¨Ù‡ Ø®ÙˆØ¯Ù… Ù†Ú¯Ø±Ø´ Ù…Ø«Ø¨ØªÛŒ Ø¯Ø§Ø±Ù…."
        ];

        const bodyImageQuestions = [
            "Ù…Ù† Ø§Ø² Ø¸Ø§Ù‡Ø± Ø®ÙˆØ¯Ù… Ø±Ø§Ø¶ÛŒ Ù‡Ø³ØªÙ….",
            "Ù…Ù† Ø®ÙˆØ¯Ù… Ø±Ø§ Ø§Ø² Ù†Ø¸Ø± ÙÛŒØ²ÛŒÚ©ÛŒ Ø¬Ø°Ø§Ø¨ Ù…ÛŒâ€ŒØ¯Ø§Ù†Ù….",
            "Ø§Ú©Ø«Ø± Ù…Ø±Ø¯Ù… Ù…Ù† Ø±Ø§ Ø®ÙˆØ´â€ŒÙ‚ÛŒØ§ÙÙ‡/Ø®ÙˆØ´â€ŒØªÛŒÙ¾ Ù…ÛŒâ€ŒØ¯Ø§Ù†Ù†Ø¯.",
            "Ù…Ù† Ø§Ø² Ù„Ø¨Ø§Ø³ÛŒ Ú©Ù‡ Ù…ÛŒâ€ŒÙ¾ÙˆØ´Ù… Ù„Ø°Øª Ù…ÛŒâ€ŒØ¨Ø±Ù….",
            "Ø¸Ø§Ù‡Ø± Ù…Ù† Ù†Ø³Ø¨Øª Ø¨Ù‡ Ø¯ÛŒÚ¯Ø±Ø§Ù† Ø¯Ø± Ø³Ø·Ø­ Ø¨Ø§Ù„Ø§ÛŒÛŒ Ø§Ø³Øª.",
            "Ù…Ù† Ø²Ù…Ø§Ù† Ø²ÛŒØ§Ø¯ÛŒ Ø±Ø§ ØµØ±Ù Ø¢Ø±Ø§Ø³ØªÙ† Ø¸Ø§Ù‡Ø± Ø®ÙˆØ¯ Ù…ÛŒâ€ŒÚ©Ù†Ù….",
            "Ø¨Ø±Ø§ÛŒ Ù…Ù† Ø®ÛŒÙ„ÛŒ Ù…Ù‡Ù… Ø§Ø³Øª Ú©Ù‡ Ø¯Ø± Ù‡Ø± Ù…ÙˆÙ‚Ø¹ÛŒØªÛŒ Ú†Ø·ÙˆØ± Ø¨Ù‡ Ù†Ø¸Ø± Ø¨Ø±Ø³Ù….",
            "Ù…Ù† Ù‡Ù…ÛŒØ´Ù‡ Ø³Ø¹ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ù… Ø¹ÛŒÙˆØ¨ Ø¸Ø§Ù‡Ø±ÛŒâ€ŒØ§Ù… Ø±Ø§ Ø¨Ù¾ÙˆØ´Ø§Ù†Ù….",
            "Ù‚Ø¨Ù„ Ø§Ø² Ø¨ÛŒØ±ÙˆÙ† Ø±ÙØªÙ† Ø§Ø² Ø®Ø§Ù†Ù‡ØŒ Ø¨Ø§Ø±Ù‡Ø§ Ø®ÙˆØ¯Ù… Ø±Ø§ Ø¯Ø± Ø¢ÛŒÙ†Ù‡ Ú†Ú© Ù…ÛŒâ€ŒÚ©Ù†Ù….",
            "Ø±Ø¶Ø§ÛŒØª Ø§Ø² Ø±Ù†Ú¯ Ùˆ Ú©ÛŒÙÛŒØª Ù¾ÙˆØ³Øª.",
            "Ø±Ø¶Ø§ÛŒØª Ø§Ø² ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ú†Ù‡Ø±Ù‡ (Ú†Ø´Ù…ØŒ Ø¨ÛŒÙ†ÛŒØŒ Ù„Ø¨ Ùˆ...).",
            "Ø±Ø¶Ø§ÛŒØª Ø§Ø² ØªÙ†Ø§Ø³Ø¨ Ú©Ù„ÛŒ Ø§Ù†Ø¯Ø§Ù… Ùˆ ÙˆØ²Ù†.",
            "Ø±Ø¶Ø§ÛŒØª Ø§Ø² Ù‚Ø¯.",
            "Ø±Ø¶Ø§ÛŒØª Ø§Ø² Ù…ÙˆÙ‡Ø§ÛŒ Ø³Ø±.",
            "Ø±Ø¶Ø§ÛŒØª Ø§Ø² Ø¹Ø¶Ù„Ø§Øª Ùˆ ÙØ±Ù… Ú©Ù„ÛŒ Ø¨Ø¯Ù†."
        ];

        let currentStep = 0;
        const totalSteps = 4;

        // --- 2. Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ ---
        document.addEventListener('DOMContentLoaded', () => {
            renderQuestions('rosenberg-container', rosenbergQuestions, 'q_rosen_', ['Ú©Ø§Ù…Ù„Ø§Ù‹ Ù…Ø®Ø§Ù„ÙÙ…', 'Ù…Ø®Ø§Ù„ÙÙ…', 'Ù…ÙˆØ§ÙÙ‚Ù…', 'Ú©Ø§Ù…Ù„Ø§Ù‹ Ù…ÙˆØ§ÙÙ‚Ù…']);
            renderQuestions('bodyimage-container', bodyImageQuestions, 'q_body_', ['Ø®ÛŒÙ„ÛŒ Ú©Ù…', 'Ú©Ù…', 'Ù…ØªÙˆØ³Ø·', 'Ø²ÛŒØ§Ø¯', 'Ø®ÛŒÙ„ÛŒ Ø²ÛŒØ§Ø¯']);
            updateUI();
        });

        // --- 3. ØªÙˆØ§Ø¨Ø¹ Ù†Ù…Ø§ÛŒØ´Ú¯Ø± Ø³ÙˆØ§Ù„Ø§Øª ---
        function renderQuestions(containerId, questions, prefix, options) {
            const container = document.getElementById(containerId);
            let html = '';

            questions.forEach((q, index) => {
                const qId = index + 1;
                html += `
                    <div class="question-card">
                        <div class="question-text"><span style="color:var(--accent-silver)">${qId}.</span> ${q}</div>
                        <div class="options">
                            ${options.map((opt, i) => `
                                <label class="option-label">
                                    <input type="radio" name="${prefix}${qId}" value="${i + 1}">
                                    <div class="option-custom">${opt}</div>
                                </label>
                            `).join('')}
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // --- 4. Ù…Ù†Ø·Ù‚ Ø¬Ø§Ø¨Ø¬Ø§ÛŒÛŒ Ø¨ÛŒÙ† ØµÙØ­Ø§Øª ---
        function nextStep() {
            if (!validateStep(currentStep)) return;
            
            if (currentStep < totalSteps) {
                currentStep++;
                updateUI();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function prevStep() {
            if (currentStep > 0) {
                currentStep--;
                updateUI();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function updateUI() {
            document.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
            document.getElementById(`step-${currentStep}`).classList.add('active');
            
            const progress = (currentStep / totalSteps) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
        }

        // --- 5. Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ---
        function validateStep(step) {
            if (step === 1) { // Ø¯Ù…ÙˆÚ¯Ø±Ø§ÙÛŒÚ©
                const gender = document.getElementById('gender').value;
                const age = document.getElementById('age').value;
                if (!gender || !age) {
                    alert('Ù„Ø·ÙØ§Ù‹ Ø¬Ù†Ø³ÛŒØª Ùˆ Ø³Ù† Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
                    return false;
                }
            }
            if (step === 2) { // Ø±ÙˆØ²Ù†Ø¨Ø±Ú¯
                if (!checkAllAnswered(rosenbergQuestions.length, 'q_rosen_')) {
                    alert('Ù„Ø·ÙØ§Ù‹ Ø¨Ù‡ ØªÙ…Ø§Ù… Ø³ÙˆØ§Ù„Ø§Øª Ø§ÛŒÙ† Ø¨Ø®Ø´ Ù¾Ø§Ø³Ø® Ø¯Ù‡ÛŒØ¯.');
                    return false;
                }
            }
            return true;
        }

        function checkAllAnswered(count, prefix) {
            for (let i = 1; i <= count; i++) {
                const name = `${prefix}${i}`;
                const checked = document.querySelector(`input[name="${name}"]:checked`);
                if (!checked) return false;
            }
            return true;
        }

        // --- 6. Ø§Ø±Ø³Ø§Ù„ Ù†Ù‡Ø§ÛŒÛŒ Ø¨Ù‡ Supabase (Ø¨Ø§ Ø¯ÛŒØ¨Ø§Ú¯ Ø¯Ù‚ÛŒÙ‚) ---
        async function submitForm() {
            if (!checkAllAnswered(bodyImageQuestions.length, 'q_body_')) {
                alert('Ù„Ø·ÙØ§Ù‹ Ø¨Ù‡ ØªÙ…Ø§Ù… Ø³ÙˆØ§Ù„Ø§Øª Ù¾Ø§Ø³Ø® Ø¯Ù‡ÛŒØ¯.');
                return;
            }

            const btn = document.querySelector('.btn-next');
            const originalText = btn.innerText;
            btn.innerText = 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„...';
            btn.disabled = true;

            // Ø§ØµÙ„Ø§Ø­ ÙØ±Ù…Øª Ø³Ù† (ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Ø¹Ø¯Ø¯ ØµØ­ÛŒØ­)
            const ageInput = document.getElementById('age').value;
            const ageNumber = parseInt(ageInput);
            
            if (isNaN(ageNumber)) {
                alert('Ø®Ø·Ø§: Ù„Ø·ÙØ§Ù‹ Ø³Ù† Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø¹Ø¯Ø¯ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.');
                btn.innerText = originalText;
                btn.disabled = false;
                return;
            }

            // Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
            const formData = {
                gender: document.getElementById('gender').value,
                age: ageNumber, // Ø§Ø±Ø³Ø§Ù„ Ø¹Ø¯Ø¯ Ù…Ø·Ù…Ø¦Ù†
                education: document.getElementById('education').value,
                rosenberg_raw: getAnswers(rosenbergQuestions.length, 'q_rosen_'),
                body_image_raw: getAnswers(bodyImageQuestions.length, 'q_body_')
            };

            console.log("Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„:", formData);

            try {
                // Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Supabase
                const { data, error } = await supabaseClient
                    .from('responses')
                    .insert([formData]);

                if (error) {
                    console.error('Supabase Error Detail:', error);
                    // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ø¯Ù‚ÛŒÙ‚ Ø§Ø±ÙˆØ± Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±
                    throw new Error(error.message || "Ø®Ø·Ø§ÛŒ Ù†Ø§Ø´Ù†Ø§Ø®ØªÙ‡ Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³");
                }

                // Ù…ÙˆÙÙ‚ÛŒØª
                currentStep++;
                updateUI();
                
            } catch (err) {
                console.error('Full Error:', err);
                alert('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øª Ø§Ø·Ù„Ø§Ø¹Ø§Øª: \n' + err.message + '\n\n(Ù„Ø·ÙØ§Ù‹ Ø§ÛŒÙ† Ù¾ÛŒØ§Ù… Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯)');
                btn.innerText = originalText;
                btn.disabled = false;
            }
        }

        // ØªØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù¾Ø§Ø³Ø®â€ŒÙ‡Ø§
        function getAnswers(count, prefix) {
            let answers = [];
            for (let i = 1; i <= count; i++) {
                const val = document.querySelector(`input[name="${prefix}${i}"]:checked`).value;
                answers.push(parseInt(val));
            }
            return answers;
        }
    </script>
</body>
</html>